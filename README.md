Исходная задача.
===============

Необходимо реализовать чтение значений со входа АЦП с использованием DMA
с дискретизацией 10 кГц и установки полученных усреднённых значений на выходе 
ЦАП раз в 10 миллисекунд. А так же выдачу усреднённых за 1 секунду значений 
по интерфейсу USB (Virtual COM). Полученные значения выводить в милливольтах, 
формат представления в ASCII кодах с символом перевода строки на конце 
(пример: «1500 mV\r»). Дублировать вывод информации по SWD интерфейсу в 
терминал IDE Keil.

Метод решения.
==============
			
В качестве источника сигнала выбран вход ADC1_IN0 (PA0), к которому на плате
STM32F407G-DISC1 подключена синяя кнопка, позволяющая изменять уровень на 
входе от 0 до максимального (Vdd = 3.3 V). Для формирования запросов на 
измерения с частотой 10 кГц выбран таймер 8, который указан в качестве 
внешнего тригера для АЦП 1. Количество данных для первичного усреднения 
(100 самплов) задается пользовательской константой USER_ADC_BUFFER_SIZE. 
Значение этой константы влияет на частоту загрузки значения в ЦАП (выход 1). 
Использована схема с двумя буферами ПДП и генерацией прерывания по заполнению 
каждого из них. Для этого ПДП настроен на работу с буфером удвоенной длины и 
реализованы две функции обратного вызова (для половины и всего буфера).

Для вывода значения на хост через Virtual COM задействован таймер 7, который
выставляет прерывание каждую секунду. Обработчик прерывания вычисляет 
усредненное значение, используя сумму первичных усреднений и их количество, 
которые вычисляются обработчиками прерываний ПДП. Вывод реализован с 
использованием стандартной функции printf(). Для перенаправления стандартного 
потока реализована низкоуровневая функция stdout_putchar(), осуществляющая 
накопление данных перед их передачей по USB.

Первоначальная настройка всей периферии осуществляется функциями HAL. 
Для запуска работы АЦП в режиме ПДП и доступа к ЦАП могут быть использованы 
как HAL, так и LL. Это определяется макросом USE_LL_DRIVER, определенным в 
STM32CubeMX в константах АЦП.

Получение исполняемого кода.
============================
		
 * Скачать исходные тексты из репозитария.
 * Открыть файл проекта F4DiscoTest.ioc в STM32CubeMX.
 * Осуществить генерацию кода.
 * Открыть файл проекта MDK-ARM\F4DiscoTest.uvprojx в Keil uVision.
 * В Project/Manage/Runtime Environment установить параметры Compiler I/O:
   stderr = ITM
   stdout = User
 * В Project/Options...  на странице Debug кнопка Settings страница Trace:
   Core Clock: 72.000000 (для SWO)
 * Выполнить Project/Build Target.
